# Introducing Statistical Programming with R and RStudio

*To complete the exercises, ensure that you work in your newly created project in RStudio and writing your answers in your new R script.*

```{js, echo=FALSE}
document.addEventListener('DOMContentLoaded', function() {
    var codeBlocks = document.querySelectorAll('pre > code');

    codeBlocks.forEach(function(block) {
        // Check if the block's content starts with '##'
        if (block.textContent.trim().startsWith('##')) {
            var button = document.createElement('button');
            button.className = 'toggle-button';
            button.textContent = 'Show R Output';
            button.style.display = 'block'; // Ensure button is visible
            block.style.display = 'none'; // Initially hide the R output

            button.onclick = function() {
                if (block.style.display === 'none') {
                    block.style.display = 'block';
                    button.textContent = 'Hide R Output';
                } else {
                    block.style.display = 'none';
                    button.textContent = 'Show R Output';
                }
            };

            block.parentNode.insertBefore(button, block);
        }
    });
});
```


```{js, echo=FALSE}
document.addEventListener('DOMContentLoaded', function() {
    var rComments = document.querySelectorAll('.r-comment');

    rComments.forEach(function(comment) {
        // Create the toggle button
        var button = document.createElement('button');
        button.className = 'toggle-comment-button';
        button.textContent = 'Show Explanation';
        button.style.display = 'block'; // Ensure button is visible
        comment.style.display = 'none'; // Initially hide the comment

        // Add click event listener to the button
        button.onclick = function() {
            if (comment.style.display === 'none') {
                comment.style.display = 'block'; // Adjust as needed
                button.textContent = 'Hide Explanation';
            } else {
                comment.style.display = 'none';
                button.textContent = 'Show Explanation';
            }
        };

        // Insert the button before the comment
        comment.parentNode.insertBefore(button, comment);
    });
});

```



**Learning Outcomes:** 

*- Employ the basics of the R language to run simple lines of code;*  
*- Import and export data objects.* 


**Functions you will learn: **

- 

## Basic Operations with Vectors

### Exercise: Operations with Numeric Vectors 

#### Performing Calculations on Single Numeric Vectors {-}

a. Create a vector object called `num_vct` that contains the following values: 70, 8, 50, 100.

```{r}
num_vct <- c(70, 8, 50, 100) 
```

b. Print the contents. 

```{r}
num_vct 
```
c. Multiply this vector by 2.

```{r}
num_vct * 2
```

d. Divide the vector by 10. 

```{r}
num_vct / 10
```

e. Subtract 5 from the vector. 

```{r}
num_vct - 5 
```

f. Add 8 to the vector.

```{r}
num_vct + 8  
```

#### Performing Calculations with TWO Numeric Vectors {-}

a. Create a new numeric vector that contains the following values: 5, 7, 9, 10. Name it `num_vct2` and print the contents. 

```{r}
num_vct2 <- c(5, 7, 9, 10)
```

Printing the contents. 

```{r}
num_vct2 
```

b. Add `num_vct2` to `num_vct`.  

```{r}
num_vct2 + num_vct
```

c. Divide `num_vct` by `num_vct2`. 

```{r}
num_vct / num_vct2
```

d. Multiply `num_vct2` by `num_vct`. 

```{r}
num_vct2 * num_vct
```

e. Subtract `num_vct` from `num_vct2`.

```{r}
num_vct2 - num_vct
```

### Exercise: Operations with Character Vectors

a. Create a character vector object that contains the following: I, love, programming, with, R.  Name this vector `char_vct` and print the contents.

```{r}
char_vct <- c("I", "love", "programming", "with", "R")
```

Printing the contents. 

```{r}
char_vct
```

b. Attempt to perform the operations from the previous exercise.   
What results do you obtain?   
Why?

```{r, error = TRUE, results = 'asis'}
char_vct * 2 
```

<div class="r-comment" style="display: none;"> Note the error message in the console; none of the tasks can be applied to this vector because these are all arithmetic tasks which work only on numeric vectors.
</div>

## Exploring Vectors

### Exercise 

a. Use the `class()` function to find out what type of objects `num_vct` and `char_vct` are.

The numeric vector. 

```{r}
class(num_vct)

# The output confirms that the class of `num_vct` is numeric. 
```

The character vector. 

```{r}
class(char_vct)

# The output confirms that the class of `char_vct` is character. 
```

b. The number of elements in a vector is referred to as the *length* of the vector. With small vectors such as those you have already created, you can simply count these. Alternatively, the `length()` function can be used.  

Use the `length()` function to obtain the length of the following objects: `num_vct`, `char_vct`, `num_vct2`.

The first numeric vector

```{r}
length(num_vct)
```

The character vector. 

```{r}
length(char_vct)
``` 

The second numeric vector. 

```{r}
length(num_vct2)
```

### Exercise

Create a vector object that contains the following logical and numeric values: TRUE, 6, FALSE, 10, FALSE. Name it `new_vct` . 

```{r}
new_vct <- c(TRUE, 6, FALSE, 10, FALSE)
```

Print the contents. Does the output match the contents you entered when you created the vector? Why?

```{r}
new_vct

#The output does not match the contents. Since vectors cannot contain different data types, R will force (i.e. coerce) all entered values to match, in an attempt to lose as little information as possible. In this case, the logical values are coerced to 1 and 0, corresponding to True and False respectively. This is one of the several reasons for why data cleaning is important before proceeding with data analysis; such coercions can have a significant impact on the accuracy of our data and implicitly, on your interpretation of the data.
```

## Importing and Exporting Data

Throughout the course units of this programme, you will utilise real datasets to develop your data analysis and interpretation skills. 

In this exercise, you will practice how to download, access, and import data from the UK Data Service in R. You will also have the opportunity to practice how to export data in various formats. 

**Remember to first register with the UK Data Service. Guidance on how to do this can be found in the Section 1 learning materials on Blackboard.**

### Importing Data Files  

a. Navigate to the British Social Attitudes Survey (2019) webpage on the UK Data Service website (https://beta.ukdataservice.ac.uk/datacatalogue/studies/study?id=8850#!/access-data)

Scroll down to the end of the webpage and download the dataset in both SPSS and STATA formats in your R project working directory.

To access the SPSS data file, unzip folder and open  the folders in the following sequence: *UKDA-8850-spss > spss > spss25*. Follow the same approach for accessing the STATA file. Place these two files in your root R project working directory or within a sub-folder in this directory. 

b. Import the dataset in SPSS format; name this object `bsas_spss`. 

```{r, error=TRUE}
bsas_spss <- read_spss("data/bsa2019_poverty_open.sav")

# If you have not loaded the `haven` package, you will be prompted with the following error in the R console.
```

```{r}
# Load the haven package
library(haven)
```

c. The recommended approach for a 'clean' working directory is to place all the data files you plan to use in a separate folder within your working directory. You can name this folder **data**, for example. If you want to access a data file located in your root working directory, then simply remove the `data/` component from the file path. 

```{r}
bsas_spss <- read_spss("data/bsa2019_poverty_open.sav")
```

d. Import the dataset in STATA format; name this object `bsas_stata`. 

```{r}
bsas_stata <- read_dta("data/bsa2019_poverty_open.dta")
```

e. How many observations and variables do the `bsas_spss` and `bsas_stata` objects have? Are these identical for both objects?

```{r}
# There are many different ways to find the number of observations and variables such as looking at the information in the Environment tab, or using the View() function. 

# Since both data files are identical, both objects contain an identical number of observations and variables. There are 3,224 observations and 26 variables in each data file. 
```

### Exporting Data Files

a. Export both `bsas_spss` and `bsas_stata` data objects in `.RData` format. 

```{r, eval=FALSE}
save(bsas_spss, bsas_stata, file = "bsas_objects.RData")
```

b. Export `bsas_spss` as a single object in `.RDS` format.  

```{r, eval=FALSE}
saveRDS(bsas_spss, "bsas_spss_file.RDS")
```

c. Export the `bsas_stata` object as a `.csv` file. 

```{r, eval=FALSE}
write.csv(bsas_stata, "bsas_stata_file.csv")
```

### Effects of Exporting Data Files in Specific Formats

a. Import the `.csv` file you have created and name this object `bsas_stata2`. View the contents of the `bsas_stata2` and `bsas_stata` objects. What are the differences between the two, if any? Why?

```{r, eval=FALSE}
bsas_stata2 <- read.csv("bsas_stata_file.csv")

# The`bsas_stata` objected imported with the `haven` package has accompanying metadata. When exporting data files with metadata as `.csv` files, this metadata is lost because this type of format does not support metadata in the same way that files such as SPSS and STATA do. Also, you may note that the `bsas_stata2` has 27 rather than 26 variables; by default, the `write.csv` function will automatically number each row in the data file and therefore, will produce an additional column.
```

b. Import the `.RDS` created and name this object `bsas_spss2`. 

```{r, eval=FALSE}
bsas_spss2 <- readRDS("bsas_spss_file.RDS")
```

c. Load the `.Rdata` file you created. 

```{r, eval=FALSE}
load("bsas_objects.RData")
```


## Bonus Task: Data on GitHub

**Importing Data from Github Repositories**

Many different types of data can be imported in R using either base R functions or functions from packages. However, R is not limited to importing 'hard copy' files from your machine but also supports direct import of data files located on websites for example. 

A Github Repository is a cloud-based, online platform that allows programming users to openly share research projects, associated documentation, data files, and comments with other users and/or the public. 
Explore the Johns Hopkins Whiting School of Engineering COVID-19 Github Repository (https://github.com/CSSEGISandData/COVID-19) 

1. Open the **csse_covid_19_data** folder found at the beginning of the page. 
2. Then open **the csse_covid_19_time_series** folder. 
3. Click on **time_series_covid19_confirmed_global.csv** link. 
4. Click on the  **Raw** button on the right hand side of the screen.  
5. The webpage will now show you a long series of numbers. This is the 'data file' that you need to import. Note that this file is a `.csv` file. The same base R function you have previously used will also work in this case. 

To import the data file, create a new object called `covid_johnshop`. Within the base R `.csv` function, paste the full data file web link. Do not forget to enclose this link with quotation marks. 

```{r, importing github}
covid_johnshop <- read.csv("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv")
```

View the contents of this object.

```{r, view contents}
View(covid_johnshop)
```

Find the class of the object.

```{r, class}
class(covid_johnshop)

# This object is a data frame with 289 observations and 991 variables. 
```
